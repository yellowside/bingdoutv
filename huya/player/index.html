<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>聚合直播 - 冰豆直播</title>
<meta name="Keywords" content="游戏直播,赛事直播,美女直播,户外直播,视频直播" />
<meta name="description" content="提供热门游戏直播、电竞赛事直播与游戏赛事直播，手游直播等。" />
<link href="https://cdnjs.bingdou.com.cn/bingdoulive/css/style.css" rel="stylesheet">
<link href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js"></script>
</head>
<body oncontextmenu="return false" onselectstart="return false">
<header>
  <div class="header wrap">
  <h1 class="logo"><a href="/" title="冰豆直播"><i class="fa fa-video-camera"></i>冰豆直播</a></h1>
  <div class="menu">
    <div class="menu-icon"></div>
    <div class="menu-container" id="menu"></div>
  </div>
</div>
</header>
<main class="wrap">
  <section class="list wrap-inner" id="playerContainer" style="display:none;">
    <div class="list-header">
      <h3>正在播放-<span id="liveTitle"></span></h3>
    </div>
    <div class="list-w list-box" style="margin-bottom:20px;margin-right:0">
      <iframe name="player" id="playbox" allowfullscreen="true" frameborder="no" height="100%" width="100%" scrolling="no"></iframe>
    </div>
  </section>
  <section class="list wrap-inner">
    <div class="list-header">
      <h3>播放线路</h3>
    </div>
    <div class="list-w list-box playlist" id="playlist"></div>
  </section>
  <section class="list wrap-inner">
    <div class="list-header">
      <h3>免责声明</h3>
    </div>
    <div class="list-text-box">
      <p>　　本站所有内容均自动搜索链接于互联网第三方网站页面，并不存储任何视频、音频资源。因此经由本站搜索所产生的任何结果皆不代表本站立场，本站不对其真实合法性以及版权负责，亦不承担任何法律责任。本站所有接口皆源于互联网，仅供学习交流。</p>
    </div>
  </section>
</main>
<footer id="foot"></footer>
<script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script>
<script>
$('#menu').load('../../menu.html');
$('#foot').load('../../foot.html');
</script>
<script>
// 获取URL参数
function getQueryParam(name) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(name);
}

// 主逻辑
(function() {
  const videoid = getQueryParam('id') || '';
  const playerContainer = document.getElementById('playerContainer');
  const liveTitle = document.getElementById('liveTitle');
  const playlist = document.getElementById('playlist');
  const playbox = document.getElementById('playbox');
  
  if(!videoid) {
    playlist.innerHTML = '<p>缺少视频ID参数</p>';
    return;
  }

  // 获取直播数据
  fetch(`https://json.bingdou.cc/huya/?id=${videoid}`)
    .then(response => response.json())
    .then(data => {
      if(!data || !data.data || !data.data.length) {
        playlist.innerHTML = '<p>未找到有效直播源</p>';
        return;
      }

      // 渲染播放列表
      let html = '';
      data.data.forEach((live, index) => {
        const encodedUrl = btoa(live.url);
        html += `<li><a id="line${index+1}" href="https://player.misidao.cn/base64/live/?url=${encodedUrl}" target="player" title="${live.title}" onclick="switchLine(${index+1})">${live.title}</a></li>`;
      });
      playlist.innerHTML = html;

      // 默认播放第一条线路
      switchLine(1, btoa(data.data[0].url), data.title);
      liveTitle.textContent = data.title;
      playerContainer.style.display = 'block';
    })
    .catch(error => {
      playlist.innerHTML = '<p>数据加载失败，请刷新重试</p>';
      console.error('Error:', error);
    });

  // 线路切换函数
  window.switchLine = function(id, url, title) {
    // 更新播放器源
    playbox.src = `https://player.misidao.cn/base64/live/?url=${url}`;
    
    // 更新线路样式
    document.querySelectorAll('#playlist a').forEach(link => {
      link.style.color = link.id === `line${id}` ? 'red' : 'orange';
    });
  }
})();
</script>
</body>
</html>