<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>音乐聆听 - 冰豆直播</title>
<meta name="Keywords" content="音乐,在线听歌,音乐播放器,音乐网站,排行榜,热门歌曲,经典老歌" />
<meta name="description" content="海量音乐在线试听、新歌热歌在线首发、MV观看等，是互联网音乐播放和下载的优选。" />
<link href="https://cdnjs.bingdou.com.cn/bingdoulive/css/style.css" rel="stylesheet">
<link href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body oncontextmenu="return false" onselectstart="return false">
<header>
  <div class="header wrap">
    <h1 class="logo"><a href="/" title="冰豆直播"><i class="fa fa-video-camera"></i>冰豆直播</a></h1>
    <div class="menu">
      <div class="menu-icon"></div>
      <div class="menu-container" id="menu"></div>
    </div>
  </div>
</header>
<main class="wrap">
  <section class="list wrap-inner">
    <div class="list-header">
      <h3 id="playlist-title">正在加载歌单...</h3>
    </div>
    <div class="list-w list-box playlist" id="song-list">
      正在加载歌曲列表...
    </div>
  </section>
</main>
<footer id="foot"></footer>
<script type="text/javascript" src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.3.1/jquery.min.js"></script>
<script>
$('#menu').load('../../menu.html');
$('#foot').load('../../foot.html');
</script>
<script>
// 获取 URL 中的 id 参数
function getUrlParam(paramName) {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get(paramName);
}

const videoid = getUrlParam('id');

if (videoid) {
    // 请求 JSON 数据
    fetch(`https://json.bingdou.cc/music/?id=${videoid}`)
        .then(response => response.json())
        .then(data => {
            if (data && data.data && Array.isArray(data.data)) {
                const songListContainer = document.getElementById("song-list");
                const titleContainer = document.getElementById("playlist-title");
                titleContainer.textContent = data.title || "未知歌单";

                songListContainer.innerHTML = ""; // 清空旧内容

                data.data.forEach(song => {
                    const a = document.createElement("a");
                    const li = document.createElement("li");

                    const url = new URL(song.url);
                    const id = url.searchParams.get("id");

                    a.href = `../player/?id=${id}`;
                    a.textContent = song.name;
                    a.title = song.name;
                    a.target = "_blank";

                    li.appendChild(a);
                    songListContainer.appendChild(li);
                });
            } else {
                document.getElementById("song-list").innerHTML = "没有找到歌曲数据。";
            }
        })
        .catch(error => {
            console.error("请求失败:", error);
            document.getElementById("song-list").innerHTML = "加载数据出错，请刷新重试。";
        });
} else {
    document.getElementById("playlist-title").textContent = "错误：缺少参数 id";
    document.getElementById("song-list").innerHTML = "请提供有效的歌单 ID。";
}
</script>

</body>
</html>