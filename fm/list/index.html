<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>网络电台 - 冰豆直播</title>
<meta name="Keywords" content="广播电台,广播,FM,网络电台,在线收听" />
<meta name="description" content="囊括数千家FM广播电台,聚焦精品收听服务,提供有价值、有深度、有品质的声音内容。" />
<link href="https://cdnjs.bingdou.com.cn/bingdoulive/css/style.css" rel="stylesheet">
  <link href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body oncontextmenu="return false" onselectstart="return false">
<header>
  <div class="header wrap">
  <h1 class="logo"><a href="/" title="冰豆直播"><i class="fa fa-video-camera"></i>冰豆直播</a></h1>
  <div class="menu">
    <div class="menu-icon"></div>
    <div class="menu-container" id="menu"></div>
  </div>
</div>
</header>
<main class="wrap">
  <section class="list wrap-inner">
    <div class="list-header">
      <h3>正在播放</h3>
    </div>
    <div class="list-w list-box" style="margin-bottom:20px;margin-right:0">
      <iframe id="playbox" allowfullscreen="true" frameborder="no" height="100%" width="100%" scrolling="no" src=""></iframe>
    </div>
  </section> 
  <section class="list wrap-inner">
    <div class="list-header">
      <h3 id="radioName">加载中...</h3>
    </div>
    <div class="list-w list-box playlist" id="playlist-container"></div>
  </section>
</main>
<footer id="foot"></footer>
<script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script>
<script>
$('#menu').load('../../menu.html');
$('#foot').load('../../foot.html');
</script>
<script>
    // 获取 URL 参数
    function getUrlParams(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    const id = getUrlParams('id');
    const name = getUrlParams('name');

    // 设置标题
    if (name) {
      document.title = `${name} - 网络电台 - 冰豆直播`;
      document.getElementById('radioName').innerText = name;
    }

    // 设置播放器 iframe 的 src
    if (id && name) {
      document.getElementById('playbox').src = `https://api.bingdou.wang/fm/list/?id=${id}&name=${encodeURIComponent(name)}`;
    }

    // 加载播放列表
    if (id) {
      fetch(`https://json.bingdou.cc/fm/?id=${id}`)
        .then(response => response.json())
        .then(data => {
          const playlistContainer = document.getElementById('playlist-container');
          if (data && data.data && Array.isArray(data.data)) {
            data.data.forEach(item => {
              const li = document.createElement('li');
              const a = document.createElement('a');
              a.href = `../player/?id=${item.content_id}`;
              a.title = item.title;
              a.target = '_blank';
              a.textContent = item.title;
              li.appendChild(a);
              playlistContainer.appendChild(li);
            });
          } else {
            playlistContainer.innerHTML = '<p>暂无节目单。</p>';
          }
        })
        .catch(error => {
          console.error("加载失败:", error);
          document.getElementById('playlist-container').innerHTML = '<p>加载播放列表失败。</p>';
        });
    }
  </script>
</body>
</html>