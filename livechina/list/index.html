<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>全景直播 - 直播中国 - 冰豆直播</title>
<meta name="Keywords" content="直播中国,慢直播,城市,风景,文化" />
<meta name="description" content="展现美丽中国、城市地标、中国村庄、魅力小镇、一带一路等于一体,运用5G+4K+AI技术" />
<link href="https://cdnjs.bingdou.com.cn/bingdoulive/css/style.css" rel="stylesheet">
<link href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
</head>
<body oncontextmenu="return false" onselectstart="return false">
<header>
  <div class="header wrap">
  <h1 class="logo"><a href="/" title="冰豆直播"><i class="fa fa-video-camera"></i>冰豆直播</a></h1>
  <div class="menu">
    <div class="menu-icon"></div>
    <div class="menu-container" id="menu"></div>
  </div>
</div>
</header>
<main class="wrap">
  <div class="list wrap-inner">
    <div class="list-header">
       <h3 id="page-title">加载中...</h3>
    </div>
    <div class="list-w list-box playlist" id="playlist-container">
        <p>正在加载节目单...</p>
	</div>
  </div>
</main>
<footer id="foot"></footer>
<script src="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/jquery/3.6.0/jquery.min.js"></script>
<script>
$('#menu').load('../../menu.html');
$('#foot').load('../../foot.html');
</script>
<script>
    // 获取 URL 中的 name 参数
    const urlParams = new URLSearchParams(window.location.search);
    const name = urlParams.get('name');

    // 设置页面标题
    document.title = "全景直播 - 直播中国 - 冰豆直播";

    if (!name) {
      document.getElementById('page-title').innerText = '请传入有效的分类名称';
      document.getElementById('playlist-container').innerHTML = '<p>缺少参数：name</p>';
      throw new Error("缺少参数：name");
    }

    document.getElementById('page-title').innerText = name;

    const apiUrl = `https://json.bingdou.cc/livechina/list/?name=${encodeURIComponent(name)}`;

    fetch(apiUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error(`网络响应失败：${response.status}`);
        }
        return response.json();
      })
      .then(data => {
        if (!data || !data.data || !data.data.list || !Array.isArray(data.data.list)) {
          document.getElementById('playlist-container').innerHTML = '<p>没有找到节目单数据。</p>';
          return;
        }

        const playlistContainer = document.getElementById('playlist-container');
        playlistContainer.innerHTML = '';

        data.data.list.forEach((live, index) => {
          const li = document.createElement('li');
          const a = document.createElement('a');
          a.href = `../player/?id=${live.interaction_id}`;
          a.title = live.title || `直播 ${index + 1}`;
          a.target = '_blank';
          a.textContent = live.title || `直播 ${index + 1}`;
          li.appendChild(a);
          playlistContainer.appendChild(li);
        });
      })
      .catch(error => {
        console.error('加载失败:', error);
        document.getElementById('playlist-container').innerHTML = `加载播放列表失败`;
      });
  </script>
</body>
</html>